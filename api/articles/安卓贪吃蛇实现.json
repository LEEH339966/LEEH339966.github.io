{"title":"安卓贪吃蛇小游戏实现","slug":"安卓贪吃蛇实现","date":"2020-09-14T06:44:12.118Z","updated":"2020-09-16T04:40:22.730Z","comments":true,"path":"api/articles/安卓贪吃蛇实现.json","photos":[],"link":"","excerpt":"1. 概述1.1 项目背景  近年来随着手机技术的不断发展古老的贪吃蛇游戏不能给与广大青少年的良好游戏体验，所以本文再基于古老的贪吃蛇游戏上对游戏进行了改进使得玩法更加多样有趣。1.2 研究的主要内容  研究的主要内容包括对蛇如何进行控制，实现食物的随机生成，并且对蛇可以进行加速控制。游戏得分等","covers":["https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-821ad04eda1da070.jpg","https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-592247328519c7c2.png","https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-1e8327f1da18f0a1.png"],"content":"<hr>\n<h1 id=\"1-概述\"><a href=\"#1-概述\" class=\"headerlink\" title=\"1. 概述\"></a><strong>1.</strong> <strong>概述</strong></h1><h2 id=\"1-1-项目背景\"><a href=\"#1-1-项目背景\" class=\"headerlink\" title=\"1.1 项目背景\"></a>1.1 项目背景</h2><p>  近年来随着手机技术的不断发展古老的贪吃蛇游戏不能给与广大青少年的良好游戏体验，所以本文再基于古老的贪吃蛇游戏上对游戏进行了改进使得玩法更加多样有趣。</p>\n<h2 id=\"1-2-研究的主要内容\"><a href=\"#1-2-研究的主要内容\" class=\"headerlink\" title=\"1.2 研究的主要内容\"></a>1.2 研究的主要内容</h2><p>  研究的主要内容包括对蛇如何进行控制，实现食物的随机生成，并且对蛇可以进行加速控制。游戏得分等</p>\n<a id=\"more\"></a>\n<p><img src=\"https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-821ad04eda1da070.jpg\" alt=\"我是一张图\"></p>\n<h1 id=\"2-相关技术\"><a href=\"#2-相关技术\" class=\"headerlink\" title=\"2. 相关技术\"></a><strong>2.</strong> <strong>相关技术</strong></h1><p>采用的技术有 多线程 自定义View 以及一个activity</p>\n<h1 id=\"3-系统分析\"><a href=\"#3-系统分析\" class=\"headerlink\" title=\"3. 系统分析\"></a><strong>3.</strong> <strong>系统分析</strong></h1><p>此为一个新版的贪吃蛇游戏，设计的游戏需要蛇的移动、加速、增长、死亡功能。程文件主要包括src文件夹（Java源码）、res文件夹（资源文件）和AndroidMainfest.xml（程序清单）。软件主要由Activities，自定义view 组成 View主要用来绘制图形并进行逻辑的处理。Activity主要实现对蛇的控制和对用户的交互信息等</p>\n<h1 id=\"4-系统设计\"><a href=\"#4-系统设计\" class=\"headerlink\" title=\"4. 系统设计\"></a><strong>4.</strong> <strong>系统设计</strong></h1><p><img src=\"https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-592247328519c7c2.png\" alt=\"图1游戏组成\"></p>\n<h1 id=\"5-系统实现\"><a href=\"#5-系统实现\" class=\"headerlink\" title=\"5. 系统实现\"></a><strong>5.</strong> <strong>系统实现</strong></h1><p>1、游戏界面<br><img src=\"https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-1e8327f1da18f0a1.png\" alt=\"图2开始界面\"><br><img src=\"https://leehbucket1.oss-cn-beijing.aliyuncs.com/img/11634944-618ff34c5c72a329.png\" alt=\"图3\"><br><img src=\"https://upload-images.jianshu.io/upload_images/11634944-21c4e47d8efc42cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/200\" alt=\"图4暂停界面\"><br><img src=\"https://upload-images.jianshu.io/upload_images/11634944-ae07b23a23d6c616.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/200\" alt=\"图5结束界面\"><br><img src=\"https://upload-images.jianshu.io/upload_images/11634944-181a6b56564e5def.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/200\" alt=\"图6穿墙界面\"></p>\n<h4 id=\"实现该模块的核心代码如下：\"><a href=\"#实现该模块的核心代码如下：\" class=\"headerlink\" title=\"实现该模块的核心代码如下：\"></a>实现该模块的核心代码如下：</h4><p><strong><em>TileView.java</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package cn.edu.zust.lihuan;</span><br><span class=\"line\">import android.content.Context;</span><br><span class=\"line\">import android.content.res.TypedArray;</span><br><span class=\"line\">import android.graphics.Bitmap;</span><br><span class=\"line\">import android.graphics.Canvas;</span><br><span class=\"line\">import android.graphics.Paint;</span><br><span class=\"line\">import android.graphics.drawable.Drawable;</span><br><span class=\"line\">import android.util.AttributeSet;</span><br><span class=\"line\">import android.view.View;</span><br><span class=\"line\">public class TileView extends View &#123;</span><br><span class=\"line\">    protected static int mTileSize;</span><br><span class=\"line\">    protected static int mXTileCount;</span><br><span class=\"line\">    protected static int mYTileCount;</span><br><span class=\"line\">    private static int mXOffset;</span><br><span class=\"line\">    private static int mYOffset;</span><br><span class=\"line\">    private Bitmap[] mTileArray;</span><br><span class=\"line\">    private int[][] mTileGrid;</span><br><span class=\"line\">    private final Paint mPaint &#x3D; new Paint();</span><br><span class=\"line\">    public TileView(Context context, AttributeSet attrs, int defStyle) &#123;</span><br><span class=\"line\">        super(context, attrs, defStyle);</span><br><span class=\"line\"></span><br><span class=\"line\">        TypedArray a &#x3D; context.obtainStyledAttributes(attrs, R.styleable.TileView);</span><br><span class=\"line\"></span><br><span class=\"line\">        mTileSize &#x3D; a.getInt(R.styleable.TileView_tileSize, 32);</span><br><span class=\"line\"></span><br><span class=\"line\">        a.recycle();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public TileView(Context context, AttributeSet attrs) &#123;</span><br><span class=\"line\">        this(context, attrs, 0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public void resetTiles(int tilecount) &#123;</span><br><span class=\"line\">        mTileArray &#x3D; new Bitmap[tilecount];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void onSizeChanged(int w, int h, int oldw, int oldh) &#123;</span><br><span class=\"line\">        mXTileCount &#x3D; (int) Math.floor(w &#x2F; mTileSize);</span><br><span class=\"line\">        mYTileCount &#x3D; (int) Math.floor(h &#x2F; mTileSize);</span><br><span class=\"line\"></span><br><span class=\"line\">        mXOffset &#x3D; ((w - (mTileSize * mXTileCount)) &#x2F; 2);</span><br><span class=\"line\">        mYOffset &#x3D; ((h - (mTileSize * mYTileCount)) &#x2F; 2);</span><br><span class=\"line\"></span><br><span class=\"line\">        mTileGrid &#x3D; new int[mXTileCount][mYTileCount];</span><br><span class=\"line\">        clearTiles();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public void loadTile(int key, Drawable tile) &#123;</span><br><span class=\"line\">        Bitmap bitmap &#x3D; Bitmap.createBitmap(mTileSize, mTileSize, Bitmap.Config.ARGB_8888);</span><br><span class=\"line\">        Canvas canvas &#x3D; new Canvas(bitmap);</span><br><span class=\"line\">        tile.setBounds(0, 0, mTileSize, mTileSize);</span><br><span class=\"line\">        tile.draw(canvas);</span><br><span class=\"line\"></span><br><span class=\"line\">        mTileArray[key] &#x3D; bitmap;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public void clearTiles() &#123;</span><br><span class=\"line\">        for (int x &#x3D; 0; x &lt; mXTileCount; x++) &#123;</span><br><span class=\"line\">            for (int y &#x3D; 0; y &lt; mYTileCount; y++) &#123;</span><br><span class=\"line\">                setTile(0, x, y);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public void setTile(int tileindex, int x, int y) &#123;</span><br><span class=\"line\">        mTileGrid[x][y] &#x3D; tileindex;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void onDraw(Canvas canvas) &#123;</span><br><span class=\"line\">        super.onDraw(canvas);</span><br><span class=\"line\">        for (int x &#x3D; 0; x &lt; mXTileCount; x +&#x3D; 1) &#123;</span><br><span class=\"line\">            for (int y &#x3D; 0; y &lt; mYTileCount; y +&#x3D; 1) &#123;</span><br><span class=\"line\">                if (mTileGrid[x][y] &gt; 0) &#123;</span><br><span class=\"line\">                    canvas.drawBitmap(mTileArray[mTileGrid[x][y]],</span><br><span class=\"line\">                            mXOffset + x * mTileSize,</span><br><span class=\"line\">                            mYOffset + y * mTileSize,</span><br><span class=\"line\">                            mPaint);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><strong><em>Snake.java</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">package cn.edu.zust.lihuan;</span><br><span class=\"line\">import android.app.Activity;</span><br><span class=\"line\">import android.content.res.Resources;</span><br><span class=\"line\">import android.os.Bundle;</span><br><span class=\"line\">import android.os.Vibrator;</span><br><span class=\"line\">import android.view.MotionEvent;</span><br><span class=\"line\">import android.view.View;</span><br><span class=\"line\">import android.view.Window;</span><br><span class=\"line\">import android.widget.Button;</span><br><span class=\"line\">import android.widget.TextView;</span><br><span class=\"line\">import static android.view.MotionEvent.ACTION_DOWN;</span><br><span class=\"line\">import static android.view.MotionEvent.ACTION_UP;</span><br><span class=\"line\">public class   Snake extends Activity &#123;</span><br><span class=\"line\">    private SnakeView mSnakeView;</span><br><span class=\"line\">    private Button mBt_up, mBt_down, mBt_left, mBt_right, mBt_home;</span><br><span class=\"line\">    private Vibrator vibrator;</span><br><span class=\"line\">    private Resources r;</span><br><span class=\"line\">    private static String ICICLE_KEY &#x3D; &quot;snake-view&quot;;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void onCreate(Bundle savedInstanceState) &#123;</span><br><span class=\"line\">        super.onCreate(savedInstanceState);</span><br><span class=\"line\">        requestWindowFeature(Window.FEATURE_NO_TITLE);</span><br><span class=\"line\">        setContentView(cn.edu.zust.lihuan.R.layout.snake_layout);</span><br><span class=\"line\">        mSnakeView &#x3D; (SnakeView) findViewById(cn.edu.zust.lihuan.R.id.snake);</span><br><span class=\"line\">        mSnakeView.setTextView((TextView) findViewById(cn.edu.zust.lihuan.R.id.text));</span><br><span class=\"line\">        vibrator &#x3D; (Vibrator) getSystemService(VIBRATOR_SERVICE);</span><br><span class=\"line\">        r &#x3D; getResources();</span><br><span class=\"line\">        if (savedInstanceState &#x3D;&#x3D; null) &#123;</span><br><span class=\"line\">            mSnakeView.setMode(SnakeView.READY);</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">            Bundle map &#x3D; savedInstanceState.getBundle(ICICLE_KEY);</span><br><span class=\"line\">            if (map !&#x3D; null) &#123;</span><br><span class=\"line\">                mSnakeView.restoreState(map);</span><br><span class=\"line\">            &#125; else &#123;</span><br><span class=\"line\">                mSnakeView.setMode(SnakeView.PAUSE);</span><br><span class=\"line\">                mSnakeView.setMODE(SnakeView.PAUSE);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        mBt_up &#x3D; findViewById(cn.edu.zust.lihuan.R.id.up);</span><br><span class=\"line\">        mBt_down &#x3D; findViewById(cn.edu.zust.lihuan.R.id.dowm);</span><br><span class=\"line\">        mBt_left &#x3D; findViewById(cn.edu.zust.lihuan.R.id.left);</span><br><span class=\"line\">        mBt_right &#x3D; findViewById(cn.edu.zust.lihuan.R.id.right);</span><br><span class=\"line\">        mBt_home &#x3D; findViewById(cn.edu.zust.lihuan.R.id.home);</span><br><span class=\"line\">        mBt_up.setOnTouchListener(new View.OnTouchListener() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public boolean onTouch(View view, MotionEvent motionEvent) &#123;</span><br><span class=\"line\">                switch (motionEvent.getAction()) &#123;</span><br><span class=\"line\">                    case ACTION_DOWN:</span><br><span class=\"line\">                        mSnakeView.up();</span><br><span class=\"line\">                        vibrator.vibrate(30);</span><br><span class=\"line\">                        mSnakeView.addBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                    case ACTION_UP:</span><br><span class=\"line\">                        mSnakeView.deBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                return false;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        mBt_down.setOnTouchListener(new View.OnTouchListener() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public boolean onTouch(View view, MotionEvent motionEvent) &#123;</span><br><span class=\"line\">                switch (motionEvent.getAction()) &#123;</span><br><span class=\"line\">                    case ACTION_DOWN:</span><br><span class=\"line\">                        mSnakeView.down();</span><br><span class=\"line\">                        vibrator.vibrate(30);</span><br><span class=\"line\">                        mSnakeView.addBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                    case ACTION_UP:</span><br><span class=\"line\">                        mSnakeView.deBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                return false;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        mBt_left.setOnTouchListener(new View.OnTouchListener() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public boolean onTouch(View view, MotionEvent motionEvent) &#123;</span><br><span class=\"line\">                switch (motionEvent.getAction()) &#123;</span><br><span class=\"line\">                    case ACTION_DOWN:</span><br><span class=\"line\">                        mSnakeView.left();</span><br><span class=\"line\">                        vibrator.vibrate(30);</span><br><span class=\"line\">                        mSnakeView.addBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                    case ACTION_UP:</span><br><span class=\"line\">                        mSnakeView.deBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                return false;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        mBt_right.setOnTouchListener(new View.OnTouchListener() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public boolean onTouch(View view, MotionEvent motionEvent) &#123;</span><br><span class=\"line\">                switch (motionEvent.getAction()) &#123;</span><br><span class=\"line\">                    case ACTION_DOWN:</span><br><span class=\"line\">                        mSnakeView.right();</span><br><span class=\"line\">                        vibrator.vibrate(30);</span><br><span class=\"line\">                        mSnakeView.addBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                    case ACTION_UP:</span><br><span class=\"line\">                        mSnakeView.deBuff();</span><br><span class=\"line\">                        break;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                return false;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        mBt_home.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void onClick(View view) &#123;</span><br><span class=\"line\">                changeHome();</span><br><span class=\"line\">                mSnakeView.star();</span><br><span class=\"line\">                vibrator.vibrate(300);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void onPause() &#123;</span><br><span class=\"line\">        super.onPause();</span><br><span class=\"line\">        &#x2F;&#x2F; Pause the game along with the activity</span><br><span class=\"line\">        mSnakeView.setMode(SnakeView.PAUSE);</span><br><span class=\"line\">        changeHome();</span><br><span class=\"line\">        mSnakeView.setMODE(SnakeView.PAUSE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void onSaveInstanceState(Bundle outState) &#123;</span><br><span class=\"line\">        &#x2F;&#x2F;Store the game state</span><br><span class=\"line\">        outState.putBundle(ICICLE_KEY, mSnakeView.saveState());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public void changeHome() &#123;</span><br><span class=\"line\">        if (r !&#x3D; null) &#123;</span><br><span class=\"line\">            if (mSnakeView.getMODE() &#x3D;&#x3D; mSnakeView.PAUSE ||</span><br><span class=\"line\">                    mSnakeView.getMODE() &#x3D;&#x3D; mSnakeView.READY || mSnakeView.getMODE() &#x3D;&#x3D; mSnakeView.LOSE) &#123;</span><br><span class=\"line\">                mBt_home.setBackground(r.getDrawable(R.drawable.btn_bg_home_selector));</span><br><span class=\"line\">            &#125; else if (mSnakeView.getMODE() &#x3D;&#x3D; mSnakeView.RUNNING) &#123;</span><br><span class=\"line\">                mBt_home.setBackground(r.getDrawable(R.drawable.btn_bg_home2_selector));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; else &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong><em>SnakeView.java</em></strong></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br><span class=\"line\">460</span><br><span class=\"line\">461</span><br><span class=\"line\">462</span><br><span class=\"line\">463</span><br><span class=\"line\">464</span><br><span class=\"line\">465</span><br><span class=\"line\">466</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> </span><br><span class=\"line\">package cn.edu.zust.lihuan;</span><br><span class=\"line\"></span><br><span class=\"line\">import android.content.Context;</span><br><span class=\"line\">import android.content.res.Resources;</span><br><span class=\"line\">import android.os.Bundle;</span><br><span class=\"line\">import android.os.Handler;</span><br><span class=\"line\">import android.os.Message;</span><br><span class=\"line\">import android.util.AttributeSet;</span><br><span class=\"line\">import android.util.Log;</span><br><span class=\"line\">import android.view.View;</span><br><span class=\"line\">import android.widget.TextView;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.util.ArrayList;</span><br><span class=\"line\">import java.util.Random;</span><br><span class=\"line\"></span><br><span class=\"line\">public class SnakeView extends TileView &#123;</span><br><span class=\"line\">    private static final String TAG &#x3D; &quot;SnakeView&quot;;</span><br><span class=\"line\">    private int mMode &#x3D; READY;</span><br><span class=\"line\">    public static final int PAUSE &#x3D; 0;</span><br><span class=\"line\">    public static final int READY &#x3D; 1;</span><br><span class=\"line\">    public static final int RUNNING &#x3D; 2;</span><br><span class=\"line\">    public static final int LOSE &#x3D; 3;</span><br><span class=\"line\">    private int mDirection &#x3D; NORTH;</span><br><span class=\"line\">    private int mNextDirection &#x3D; NORTH;</span><br><span class=\"line\">    private static final int NORTH &#x3D; 1;</span><br><span class=\"line\">    private static final int SOUTH &#x3D; 2;</span><br><span class=\"line\">    private static final int EAST &#x3D; 3;</span><br><span class=\"line\">    private static final int WEST &#x3D; 4;</span><br><span class=\"line\">    private static final int APPLE &#x3D; 1;</span><br><span class=\"line\">    private static final int HEAD &#x3D; 2;</span><br><span class=\"line\">    private static final int DEADHEAD &#x3D; 3;</span><br><span class=\"line\">    private static final int BODY &#x3D; 4;</span><br><span class=\"line\">    private static final int APPLE2 &#x3D; 5;</span><br><span class=\"line\">    private static int MODE &#x3D; READY;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void setMODE(int MODE) &#123;</span><br><span class=\"line\">        SnakeView.MODE &#x3D; MODE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public int getMODE() &#123;</span><br><span class=\"line\">        return MODE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long mScore &#x3D; 0;</span><br><span class=\"line\">    private long mMoveDelay &#x3D; 100;</span><br><span class=\"line\">    private boolean mBuff &#x3D; false;</span><br><span class=\"line\">    private int gorwTag &#x3D; 1;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#x2F;**</span><br><span class=\"line\">     * Give our snake some buff!</span><br><span class=\"line\">     *&#x2F;</span><br><span class=\"line\">    public void addBuff() &#123;</span><br><span class=\"line\">        if (!mBuff) &#123;</span><br><span class=\"line\">            mBuff &#x3D; true;</span><br><span class=\"line\">            mMoveDelay &#x2F;&#x3D; 5;</span><br><span class=\"line\">            loadTile(APPLE2, r.getDrawable(R.drawable.redstar));</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void deBuff() &#123;</span><br><span class=\"line\">        if (mBuff) &#123;</span><br><span class=\"line\">            mBuff &#x3D; false;</span><br><span class=\"line\">            mMoveDelay *&#x3D; 5;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        loadTile(APPLE2, r.getDrawable(R.drawable.greenstar));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private long mLastMove;</span><br><span class=\"line\">    private TextView mStatusText;</span><br><span class=\"line\">    private ArrayList&lt;Coordinate&gt; mSnakeTrail &#x3D; new ArrayList&lt;Coordinate&gt;();</span><br><span class=\"line\">    private ArrayList&lt;Coordinate&gt; mAppleList &#x3D; new ArrayList&lt;Coordinate&gt;();</span><br><span class=\"line\">    private ArrayList&lt;Coordinate&gt; mAppleList2 &#x3D; new ArrayList&lt;Coordinate&gt;();</span><br><span class=\"line\">    &#x2F;**</span><br><span class=\"line\">     * Everyone needs a little randomness in their life</span><br><span class=\"line\">     *&#x2F;</span><br><span class=\"line\">    private static final Random RNG &#x3D; new Random();</span><br><span class=\"line\">    private RefreshHandler mRedrawHandler &#x3D; new RefreshHandler();</span><br><span class=\"line\">    Resources r &#x3D; this.getContext().getResources();</span><br><span class=\"line\"></span><br><span class=\"line\">    class RefreshHandler extends Handler &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void handleMessage(Message msg) &#123;</span><br><span class=\"line\">            SnakeView.this.update();</span><br><span class=\"line\">            SnakeView.this.invalidate();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        public void sleep(long delayMillis) &#123;</span><br><span class=\"line\">            this.removeMessages(0);</span><br><span class=\"line\">            &#x2F;&#x2F;     Toast.makeText(SnakeView.this.getContext(),&quot;这是一个TOAST&quot;,Toast.LENGTH_SHORT).show();</span><br><span class=\"line\">            sendMessageDelayed(obtainMessage(0), delayMillis);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public SnakeView(Context context, AttributeSet attrs) &#123;</span><br><span class=\"line\">        this(context, attrs, 0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public SnakeView(Context context, AttributeSet attrs, int defStyle) &#123;</span><br><span class=\"line\">        super(context, attrs, defStyle);</span><br><span class=\"line\">        initSnakeView();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void initSnakeView() &#123;</span><br><span class=\"line\">        setFocusable(true);</span><br><span class=\"line\">        resetTiles(6);</span><br><span class=\"line\">        loadTile(HEAD, r.getDrawable(cn.edu.zust.lihuan.R.drawable.head));</span><br><span class=\"line\">        loadTile(APPLE, r.getDrawable(cn.edu.zust.lihuan.R.drawable.apple));</span><br><span class=\"line\">        loadTile(BODY, r.getDrawable(cn.edu.zust.lihuan.R.drawable.body));</span><br><span class=\"line\">        loadTile(DEADHEAD, r.getDrawable(cn.edu.zust.lihuan.R.drawable.deadhead));</span><br><span class=\"line\">        loadTile(APPLE2, r.getDrawable(R.drawable.redstar));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void initNewGame() &#123;</span><br><span class=\"line\">        mSnakeTrail.clear();</span><br><span class=\"line\">        mAppleList.clear();</span><br><span class=\"line\">        mAppleList2.clear();</span><br><span class=\"line\">        gorwTag &#x3D; 1;</span><br><span class=\"line\">        &#x2F;&#x2F; that&#39;s just turned north</span><br><span class=\"line\">        for (int i &#x3D; 4; i &gt; 0; i--) &#123;</span><br><span class=\"line\">            mSnakeTrail.add(new Coordinate(i, 7));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        mNextDirection &#x3D; NORTH;</span><br><span class=\"line\">        &#x2F;&#x2F; How many apples to start with</span><br><span class=\"line\">        for (int i &#x3D; 0; i &lt; 100; i++) &#123;</span><br><span class=\"line\">            addRandomApple();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        for (int i &#x3D; 0; i &lt; 5; i++) &#123;</span><br><span class=\"line\">            addRandomApple2();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        &#x2F;&#x2F;init time of snake</span><br><span class=\"line\">        mMoveDelay &#x3D; 300;</span><br><span class=\"line\">        mScore &#x3D; 0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private int[] coordArrayListToArray(ArrayList&lt;Coordinate&gt; cvec) &#123;</span><br><span class=\"line\">        int count &#x3D; cvec.size();</span><br><span class=\"line\">        int[] rawArray &#x3D; new int[count * 2];</span><br><span class=\"line\">        for (int index &#x3D; 0; index &lt; count; index++) &#123;</span><br><span class=\"line\">            Coordinate c &#x3D; cvec.get(index);</span><br><span class=\"line\">            rawArray[2 * index] &#x3D; c.x;</span><br><span class=\"line\">            rawArray[2 * index + 1] &#x3D; c.y;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return rawArray;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public Bundle saveState() &#123;</span><br><span class=\"line\">        Bundle map &#x3D; new Bundle();</span><br><span class=\"line\">        map.putIntArray(&quot;mAppleList&quot;, coordArrayListToArray(mAppleList));</span><br><span class=\"line\">        map.putIntArray(&quot;mAppleList2&quot;, coordArrayListToArray(mAppleList2));</span><br><span class=\"line\">        map.putInt(&quot;mDirection&quot;, Integer.valueOf(mDirection));</span><br><span class=\"line\">        map.putInt(&quot;mNextDirection&quot;, Integer.valueOf(mNextDirection));</span><br><span class=\"line\">        map.putLong(&quot;mMoveDelay&quot;, Long.valueOf(mMoveDelay));</span><br><span class=\"line\">        map.putLong(&quot;mScore&quot;, Long.valueOf(mScore));</span><br><span class=\"line\">        map.putIntArray(&quot;mSnakeTrail&quot;, coordArrayListToArray(mSnakeTrail));</span><br><span class=\"line\">        return map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private ArrayList&lt;Coordinate&gt; coordArrayToArrayList(int[] rawArray) &#123;</span><br><span class=\"line\">        ArrayList&lt;Coordinate&gt; coordArrayList &#x3D; new ArrayList&lt;Coordinate&gt;();</span><br><span class=\"line\">        int coordCount &#x3D; rawArray.length;</span><br><span class=\"line\">        for (int index &#x3D; 0; index &lt; coordCount; index +&#x3D; 2) &#123;</span><br><span class=\"line\">            Coordinate c &#x3D; new Coordinate(rawArray[index], rawArray[index + 1]);</span><br><span class=\"line\">            coordArrayList.add(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        return coordArrayList;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void restoreState(Bundle icicle) &#123;</span><br><span class=\"line\">        setMode(PAUSE);</span><br><span class=\"line\">        mAppleList &#x3D; coordArrayToArrayList(icicle.getIntArray(&quot;mAppleList&quot;));</span><br><span class=\"line\">        mAppleList2 &#x3D; coordArrayToArrayList(icicle.getIntArray(&quot;mAppleList2&quot;));</span><br><span class=\"line\">        mDirection &#x3D; icicle.getInt(&quot;mDirection&quot;);</span><br><span class=\"line\">        mNextDirection &#x3D; icicle.getInt(&quot;mNextDirection&quot;);</span><br><span class=\"line\">        mMoveDelay &#x3D; icicle.getLong(&quot;mMoveDelay&quot;);</span><br><span class=\"line\">        mScore &#x3D; icicle.getLong(&quot;mScore&quot;);</span><br><span class=\"line\">        mSnakeTrail &#x3D; coordArrayToArrayList(icicle.getIntArray(&quot;mSnakeTrail&quot;));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void star() &#123;</span><br><span class=\"line\">        if (mMode &#x3D;&#x3D; READY | mMode &#x3D;&#x3D; LOSE) &#123;</span><br><span class=\"line\">            initNewGame();</span><br><span class=\"line\">            setMode(RUNNING);</span><br><span class=\"line\">            this.MODE &#x3D; RUNNING;</span><br><span class=\"line\">            update();</span><br><span class=\"line\">        &#125; else if (mMode &#x3D;&#x3D; PAUSE) &#123;</span><br><span class=\"line\">            setMode(RUNNING);</span><br><span class=\"line\">            this.MODE &#x3D; RUNNING;</span><br><span class=\"line\">            update();</span><br><span class=\"line\">        &#125; else if (mMode &#x3D;&#x3D; RUNNING) &#123;</span><br><span class=\"line\">            setMode(PAUSE);</span><br><span class=\"line\">            this.MODE &#x3D; PAUSE;</span><br><span class=\"line\">            update();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void up() &#123;</span><br><span class=\"line\">        if (mDirection !&#x3D; SOUTH) &#123;</span><br><span class=\"line\">            mNextDirection &#x3D; NORTH;</span><br><span class=\"line\">            loadTile(HEAD, r.getDrawable(R.drawable.head));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void down() &#123;</span><br><span class=\"line\">        if (mDirection !&#x3D; NORTH) &#123;</span><br><span class=\"line\">            mNextDirection &#x3D; SOUTH;</span><br><span class=\"line\">            loadTile(HEAD, r.getDrawable(R.drawable.head2));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void left() &#123;</span><br><span class=\"line\">        if (mDirection !&#x3D; EAST) &#123;</span><br><span class=\"line\">            mNextDirection &#x3D; WEST;</span><br><span class=\"line\">            loadTile(HEAD, r.getDrawable(R.drawable.head3));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void right() &#123;</span><br><span class=\"line\">        if (mDirection !&#x3D; WEST) &#123;</span><br><span class=\"line\">            mNextDirection &#x3D; EAST;</span><br><span class=\"line\">            loadTile(HEAD, r.getDrawable(R.drawable.head4));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setTextView(TextView newView) &#123;</span><br><span class=\"line\">        mStatusText &#x3D; newView;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void setMode(int newMode) &#123;</span><br><span class=\"line\">        int oldMode &#x3D; mMode;</span><br><span class=\"line\">        mMode &#x3D; newMode;</span><br><span class=\"line\"></span><br><span class=\"line\">        if (newMode &#x3D;&#x3D; RUNNING &amp; oldMode !&#x3D; RUNNING) &#123;</span><br><span class=\"line\">            mStatusText.setVisibility(View.INVISIBLE);</span><br><span class=\"line\">            update();</span><br><span class=\"line\">            return;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Resources res &#x3D; getContext().getResources();</span><br><span class=\"line\">        CharSequence str &#x3D; &quot;&quot;;</span><br><span class=\"line\">        if (newMode &#x3D;&#x3D; PAUSE) &#123;</span><br><span class=\"line\">            str &#x3D; res.getText(cn.edu.zust.lihuan.R.string.mode_pause);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (newMode &#x3D;&#x3D; READY) &#123;</span><br><span class=\"line\">            str &#x3D; res.getText(cn.edu.zust.lihuan.R.string.mode_ready);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (newMode &#x3D;&#x3D; LOSE) &#123;</span><br><span class=\"line\">            str &#x3D; res.getString(cn.edu.zust.lihuan.R.string.mode_lose_prefix) + mScore</span><br><span class=\"line\">                    + res.getString(cn.edu.zust.lihuan.R.string.mode_lose_suffix);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        mStatusText.setText(str);</span><br><span class=\"line\">        mStatusText.setVisibility(View.VISIBLE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void addRandomApple() &#123;</span><br><span class=\"line\">        Coordinate newCoord &#x3D; null;</span><br><span class=\"line\">        boolean found &#x3D; false;</span><br><span class=\"line\">        while (!found) &#123;</span><br><span class=\"line\">            &#x2F;&#x2F; Choose a new location for our apple</span><br><span class=\"line\">            int newX &#x3D; 1 + RNG.nextInt(mXTileCount - 2);</span><br><span class=\"line\">            int newY &#x3D; 1 + RNG.nextInt(mYTileCount - 2);</span><br><span class=\"line\">            newCoord &#x3D; new Coordinate(newX, newY);</span><br><span class=\"line\">            &#x2F;&#x2F; Make sure it&#39;s not already under the snake</span><br><span class=\"line\">            boolean collision &#x3D; false;</span><br><span class=\"line\">            int snakelength &#x3D; mSnakeTrail.size();</span><br><span class=\"line\">            for (int index &#x3D; 0; index &lt; snakelength; index++) &#123;</span><br><span class=\"line\">                if (mSnakeTrail.get(index).equals(newCoord)) &#123;</span><br><span class=\"line\">                    collision &#x3D; true;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            found &#x3D; !collision;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (newCoord &#x3D;&#x3D; null) &#123;</span><br><span class=\"line\">            Log.e(TAG, &quot;Somehow ended up with a null newCoord!&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        mAppleList.add(newCoord);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void addRandomApple2() &#123;</span><br><span class=\"line\">        Coordinate newCoord &#x3D; null;</span><br><span class=\"line\">        boolean found &#x3D; false;</span><br><span class=\"line\">        while (!found) &#123;</span><br><span class=\"line\">            int newX &#x3D; 1 + RNG.nextInt(mXTileCount - 2);</span><br><span class=\"line\">            int newY &#x3D; 1 + RNG.nextInt(mYTileCount - 2);</span><br><span class=\"line\">            newCoord &#x3D; new Coordinate(newX, newY);</span><br><span class=\"line\">            boolean collision &#x3D; false;</span><br><span class=\"line\">            int snakelength &#x3D; mSnakeTrail.size();</span><br><span class=\"line\">            for (int index &#x3D; 0; index &lt; snakelength; index++) &#123;</span><br><span class=\"line\">                if (mSnakeTrail.get(index).equals(newCoord)) &#123;</span><br><span class=\"line\">                    collision &#x3D; true;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            found &#x3D; !collision;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (newCoord &#x3D;&#x3D; null) &#123;</span><br><span class=\"line\">            Log.e(TAG, &quot;Somehow ended up with a null newCoord!&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        mAppleList2.add(newCoord);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public void update() &#123;</span><br><span class=\"line\">        if (mMode &#x3D;&#x3D; RUNNING) &#123;</span><br><span class=\"line\">            long now &#x3D; System.currentTimeMillis();</span><br><span class=\"line\">            if (now - mLastMove &gt; mMoveDelay) &#123;</span><br><span class=\"line\">                clearTiles();</span><br><span class=\"line\">                updateWalls();</span><br><span class=\"line\">                updateSnake();</span><br><span class=\"line\">                updateApples();</span><br><span class=\"line\">                updateApples2();</span><br><span class=\"line\">                mLastMove &#x3D; now;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            mRedrawHandler.sleep(mMoveDelay);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void updateWalls() &#123;</span><br><span class=\"line\">        for (int x &#x3D; 0; x &lt; mXTileCount; x++) &#123;</span><br><span class=\"line\">            setTile(DEADHEAD, x, 0);</span><br><span class=\"line\">            setTile(DEADHEAD, x, mYTileCount - 1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        for (int y &#x3D; 1; y &lt; mYTileCount - 1; y++) &#123;</span><br><span class=\"line\">            setTile(DEADHEAD, 0, y);</span><br><span class=\"line\">            setTile(DEADHEAD, mXTileCount - 1, y);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void updateApples() &#123;</span><br><span class=\"line\">        for (Coordinate c : mAppleList) &#123;</span><br><span class=\"line\">            setTile(APPLE, c.x, c.y);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void updateApples2() &#123;</span><br><span class=\"line\">        for (Coordinate c : mAppleList2) &#123;</span><br><span class=\"line\">            setTile(APPLE2, c.x, c.y);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private void updateSnake() &#123;</span><br><span class=\"line\">        boolean growSnake &#x3D; false;</span><br><span class=\"line\">        &#x2F;&#x2F; grab the snake by the head</span><br><span class=\"line\">        Coordinate head &#x3D; mSnakeTrail.get(0);</span><br><span class=\"line\">        Coordinate newHead &#x3D; new Coordinate(1, 1);</span><br><span class=\"line\">        mDirection &#x3D; mNextDirection;</span><br><span class=\"line\">        switch (mDirection) &#123;</span><br><span class=\"line\">            case EAST: &#123;</span><br><span class=\"line\">                newHead &#x3D; new Coordinate(head.x + 1, head.y);</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            case WEST: &#123;</span><br><span class=\"line\">                newHead &#x3D; new Coordinate(head.x - 1, head.y);</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            case NORTH: &#123;</span><br><span class=\"line\">                newHead &#x3D; new Coordinate(head.x, head.y - 1);</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            case SOUTH: &#123;</span><br><span class=\"line\">                newHead &#x3D; new Coordinate(head.x, head.y + 1);</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if ((newHead.x &lt; 1) || (newHead.x &gt; mXTileCount - 2)</span><br><span class=\"line\">                ) &#123;</span><br><span class=\"line\">            setMode(LOSE);</span><br><span class=\"line\">            return;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; else if (newHead.y &#x3D;&#x3D; 0) &#123;&#x2F;&#x2F;穿上面的墙</span><br><span class=\"line\"></span><br><span class=\"line\">            newHead.y &#x3D; mYTileCount - 2;</span><br><span class=\"line\">        &#125; else if (newHead.y &#x3D;&#x3D; mYTileCount - 1) &#123;&#x2F;&#x2F;穿下面的墙</span><br><span class=\"line\"></span><br><span class=\"line\">            newHead.y &#x3D; 1;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        int snakelength &#x3D; mSnakeTrail.size();</span><br><span class=\"line\">        for (int snakeindex &#x3D; 0; snakeindex &lt; snakelength; snakeindex++) &#123;</span><br><span class=\"line\">            Coordinate c &#x3D; mSnakeTrail.get(snakeindex);</span><br><span class=\"line\">            if (c.equals(newHead)) &#123;</span><br><span class=\"line\">                setMode(LOSE);</span><br><span class=\"line\">                return;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        int applecount &#x3D; mAppleList.size();</span><br><span class=\"line\">        int applecount2 &#x3D; mAppleList2.size();</span><br><span class=\"line\">        for (int appleindex &#x3D; 0; appleindex &lt; applecount; appleindex++) &#123;</span><br><span class=\"line\">            Coordinate c &#x3D; mAppleList.get(appleindex);</span><br><span class=\"line\">            if (c.equals(newHead)) &#123;</span><br><span class=\"line\">                mAppleList.remove(c);</span><br><span class=\"line\">                addRandomApple();</span><br><span class=\"line\">                mScore++;</span><br><span class=\"line\">                mMoveDelay *&#x3D; 0.998;</span><br><span class=\"line\">                growSnake &#x3D; true;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        for (int appleindex &#x3D; 0; appleindex &lt; applecount2; appleindex++) &#123;</span><br><span class=\"line\">            Coordinate c &#x3D; mAppleList2.get(appleindex);</span><br><span class=\"line\">            if (c.equals(newHead)) &#123;</span><br><span class=\"line\">                gorwTag &#x3D; 2;</span><br><span class=\"line\">                mAppleList2.remove(c);</span><br><span class=\"line\">                addRandomApple2();</span><br><span class=\"line\">                mScore +&#x3D; 5;</span><br><span class=\"line\">                &#x2F;&#x2F;chenge time of snake</span><br><span class=\"line\">                mMoveDelay *&#x3D; 0.998;</span><br><span class=\"line\">                growSnake &#x3D; true;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        switch (gorwTag) &#123;</span><br><span class=\"line\">            case 1:</span><br><span class=\"line\">                mSnakeTrail.add(0, newHead);</span><br><span class=\"line\">                break;</span><br><span class=\"line\"></span><br><span class=\"line\">            case 2:</span><br><span class=\"line\">                for (int i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class=\"line\">                    mSnakeTrail.add(0, newHead);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                gorwTag &#x3D; 1;</span><br><span class=\"line\">                for (int i &#x3D; 0; i &lt; 4; i++) &#123;</span><br><span class=\"line\">                    updateSnake();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            default:</span><br><span class=\"line\">                break;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        if (!growSnake) &#123;</span><br><span class=\"line\">            mSnakeTrail.remove(mSnakeTrail.size() - 1);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        &#x2F;&#x2F; draw snake</span><br><span class=\"line\">        int index &#x3D; 0;</span><br><span class=\"line\">        for (Coordinate c : mSnakeTrail) &#123;</span><br><span class=\"line\">            if (index &#x3D;&#x3D; 0) &#123;</span><br><span class=\"line\">                setTile(HEAD, c.x, c.y);</span><br><span class=\"line\">            &#125; else &#123;</span><br><span class=\"line\">                setTile(BODY, c.x, c.y);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            index++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private class Coordinate &#123;</span><br><span class=\"line\">        public int x;</span><br><span class=\"line\">        public int y;</span><br><span class=\"line\"></span><br><span class=\"line\">        public Coordinate(int newX, int newY) &#123;</span><br><span class=\"line\">            x &#x3D; newX;</span><br><span class=\"line\">            y &#x3D; newY;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        public boolean equals(Coordinate other) &#123;</span><br><span class=\"line\">            if (x &#x3D;&#x3D; other.x &amp;&amp; y &#x3D;&#x3D; other.y) &#123;</span><br><span class=\"line\">                return true;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            return false;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public String toString() &#123;</span><br><span class=\"line\">            return &quot;Coordinate: [&quot; + x + &quot;,&quot; + y + &quot;]&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#96;&#96;&#96;&#96;&#96;</span><br><span class=\"line\">snake_layout.xml</span><br></pre></td></tr></table></figure>\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<p><LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:lh=\"http://schemas.android.com/apk/res-auto\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    android:orientation=\"vertical\"></p>\n<pre><code>&lt;FrameLayout\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;0dp&quot;\n    android:layout_weight=&quot;1.5&quot;&gt;\n\n    &lt;RelativeLayout\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;wrap_content&quot;&gt;&lt;/RelativeLayout&gt;\n\n    &lt;TextView\n        android:id=&quot;@+id/text&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;300dp&quot;\n        android:layout_centerInParent=&quot;true&quot;\n        android:gravity=&quot;center_horizontal&quot;\n        android:text=&quot;@string/snake_layout_text_text&quot;\n        android:textColor=&quot;#ff8888ff&quot;\n        android:textSize=&quot;36sp&quot;\n        android:visibility=&quot;visible&quot; /&gt;\n\n    &lt;cn.edu.zust.lihuan.SnakeView\n        android:id=&quot;@+id/snake&quot;\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;400dp&quot;\n        lh:tileSize=&quot;30&quot; /&gt;\n\n\n&lt;/FrameLayout&gt;\n\n&lt;LinearLayout\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;0dp&quot;\n    android:layout_weight=&quot;1&quot;\n    android:orientation=&quot;vertical&quot;&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/up&quot;\n        android:layout_width=&quot;90dp&quot;\n        android:layout_height=&quot;1dp&quot;\n        android:layout_gravity=&quot;center_horizontal&quot;\n        android:layout_weight=&quot;1&quot;\n        android:layout_marginTop=&quot;5dp&quot;\n        android:background=&quot;@drawable/btn_bg_up_selector&quot; /&gt;\n\n    &lt;LinearLayout\n        android:layout_width=&quot;match_parent&quot;\n        android:layout_height=&quot;0dp&quot;\n        android:layout_weight=&quot;1&quot;\n        android:orientation=&quot;horizontal&quot;&gt;\n\n        &lt;Button\n            android:id=&quot;@+id/left&quot;\n            android:layout_width=&quot;0dp&quot;\n            android:layout_height=&quot;90dp&quot;\n            android:layout_marginLeft=&quot;25dp&quot;\n            android:layout_weight=&quot;1&quot;\n            android:background=&quot;@drawable/btn_bg_left_selector&quot;\n\n\n            /&gt;\n\n        &lt;Button\n            android:id=&quot;@+id/home&quot;\n            android:layout_width=&quot;0dp&quot;\n            android:layout_height=&quot;90dp&quot;\n            android:layout_weight=&quot;1&quot;\n            android:background=&quot;@drawable/btn_bg_home2_selector&quot; /&gt;\n\n        &lt;Button\n            android:id=&quot;@+id/right&quot;\n            android:layout_width=&quot;0dp&quot;\n            android:layout_height=&quot;90dp&quot;\n            android:layout_marginRight=&quot;25dp&quot;\n            android:layout_weight=&quot;1&quot;\n            android:background=&quot;@drawable/btn_bg_right_selector&quot; /&gt;\n\n    &lt;/LinearLayout&gt;\n\n    &lt;Button\n        android:id=&quot;@+id/dowm&quot;\n        android:layout_width=&quot;90dp&quot;\n        android:layout_height=&quot;0dp&quot;\n        android:layout_gravity=&quot;center_horizontal&quot;\n        android:layout_weight=&quot;1&quot;\n        android:layout_marginBottom=&quot;1dp&quot;\n        android:background=&quot;@drawable/btn_bg_down_selector&quot;\n\n        /&gt;\n\n&lt;/LinearLayout&gt;</code></pre>\n</LinearLayout>\n````\n# **6.** **总结**\n\n<p> 在程序设计的时候喜欢将界面与处理分开，这样降低耦合性，易于维护扩展。UI和游戏逻辑进行了分离， 它的实现方式就是，用父类TileView来实现比较基础的界面UI部分，而TileView类的子类SnakeView类完成了游戏控制逻辑部分，这样 就成功的将两者进行了分离，对后面的扩展和维护奠定了良好的基础。<br>#<a href=\"https://github.com/LEEH339966/repro\">github源码地址</a></p>\n","categories":[{"name":"android开发","slug":"android开发","count":1,"path":"api/categories/android开发.json"}],"tags":[{"name":"小游戏","slug":"小游戏","count":2,"path":"api/tags/小游戏.json"},{"name":"安卓开发","slug":"安卓开发","count":1,"path":"api/tags/安卓开发.json"}]}